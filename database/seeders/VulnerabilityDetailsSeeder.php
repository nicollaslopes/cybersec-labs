<?php

namespace Database\Seeders;

use App\Models\Vulnerability;
use App\Models\VulnerabilityDetails;
use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

class VulnerabilityDetailsSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $xss = Vulnerability::where('name', 'xss')->first();
        $sqlInjection = Vulnerability::where('name', 'sql_injection')->first();
        $commandInjection = Vulnerability::where('name', 'command_injection')->first();
        $csrf = Vulnerability::where('name', 'csrf')->first();
        $lfi = Vulnerability::where('name', 'lfi')->first();
        $rfi = Vulnerability::where('name', 'rfi')->first();
        $noSqlInjection = Vulnerability::where('name', 'no_sql_injection')->first();
        $typeJuggling = Vulnerability::where('name', 'type_juggling')->first();
        $ssti = Vulnerability::where('name', 'ssti')->first();
        $insecureDeserialization = Vulnerability::where('name', 'insecure_deserialization')->first();
        $jwt = Vulnerability::where('name', 'jwt')->first();


        $vulnerabilitiesDetails = [
            [
                'id_vulnerability' => $xss->id, 
                'title' => 'Reflected XSS - Level 1', 
                'name' => $xss->name, 
                'name_detail' => 'reflected_xss_level_1', 
                'type' => 'reflected', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $xss->id, 
                'title' => 'Reflected XSS - Level 2', 
                'name' => $xss->name, 
                'name_detail' => 'reflected_xss_level_2', 
                'type' => 'reflected', 
                'level' => 2, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $xss->id, 
                'title' => 'Stored XSS - Level 1', 
                'name' => $xss->name, 
                'level' => 1, 
                'name_detail' => 'stored_xss', 
                'type' => 'stored', 
                'description' => ''
            ],
            [
                'id_vulnerability' => $sqlInjection->id, 
                'title' => 'SQL Injection Error based - Level 1', 
                'name' => $sqlInjection->name, 
                'name_detail' => 'sql_injection_error_based_level_1', 
                'type' => 'error_based', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $commandInjection->id, 
                'title' => 'Command Injection - Level 1', 
                'name' => $commandInjection->name, 
                'name_detail' => 'command_injection_level_1', 
                'type' => 'normal', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $commandInjection->id, 
                'title' => 'Command Injection - Level 2', 
                'name' => $commandInjection->name, 
                'name_detail' => 'command_injection_level_2', 
                'type' => 'normal', 
                'level' => 2, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $csrf->id, 
                'title' => 'CSRF (Cross-site Request Forgery) - Level 1', 
                'name' => $csrf->name, 
                'name_detail' => 'csrf_level_1', 
                'type' => 'normal', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $lfi->id, 
                'title' => 'LFI (Local File Inclusion) - Level 1', 
                'name' => $lfi->name, 
                'name_detail' => 'lfi_level_1', 
                'type' => 'normal', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $rfi->id, 
                'title' => 'RFI (Remote File Inclusion) - Level 1', 
                'name' => $rfi->name, 
                'name_detail' => 'rfi_level_1', 
                'type' => 'normal', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $noSqlInjection->id, 
                'title' => 'NoSQL Injection - Level 1', 
                'name' => $noSqlInjection->name, 
                'name_detail' => 'no_sql_injection_level_1', 
                'type' => 'normal', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $typeJuggling->id, 
                'title' => 'Type Juggling - Level 1', 
                'name' => $typeJuggling->name, 
                'name_detail' => 'type_juggling_level_1', 
                'type' => 'normal', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $ssti->id, 
                'title' => 'SSTI (Server-side Template Injection) (Twig) - Level 1', 
                'name' => $ssti->name, 
                'name_detail' => 'ssti_twig_level_1', 
                'type' => 'twig', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $insecureDeserialization->id, 
                'title' => 'Insecure Deserialization PHP - Level 1', 
                'name' => $insecureDeserialization->name, 
                'name_detail' => 'insecure_deserialization_php_level_1', 
                'type' => 'php', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $insecureDeserialization->id, 
                'title' => 'Insecure Deserialization Node - Level 1', 
                'name' => $insecureDeserialization->name, 
                'name_detail' => 'insecure_deserialization_node_level_1', 
                'type' => 'node', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $jwt->id, 
                'title' => 'JWT Weak Secret - Level 1', 
                'name' => $jwt->name, 
                'name_detail' => 'jwt_weak_secret_level_1', 
                'type' => 'weak_secret', 
                'level' => 1, 
                'description' => ''
            ],
        ];

        foreach ($vulnerabilitiesDetails as $vuln) {
                VulnerabilityDetails::Factory()->create($vuln);
        }
    }
}
