<?php

namespace Database\Seeders;

use App\Models\Vulnerability;
use App\Models\VulnerabilityDetails;
use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

class VulnerabilityDetailsSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $xss = Vulnerability::where('name', 'xss')->first();
        $sqlInjection = Vulnerability::where('name', 'sql_injection')->first();
        $commandInjection = Vulnerability::where('name', 'command_injection')->first();

        $vulnerabilitiesDetails = [
            [
                'id_vulnerability' => $xss->id, 
                'title' => 'Reflected XSS - Level 1', 
                'name' => $xss->name, 
                'name_detail' => 'reflected_xss_level_1', 
                'type' => 'reflected', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $xss->id, 
                'title' => 'Reflected XSS - Level 2', 
                'name' => $xss->name, 
                'name_detail' => 'reflected_xss_level_2', 
                'type' => 'reflected', 
                'level' => 2, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $xss->id, 
                'title' => 'Stored XSS - Level 1', 
                'name' => $xss->name, 
                'level' => 1, 
                'name_detail' => 'stored_xss', 
                'type' => 'stored', 
                'description' => ''
            ],
            [
                'id_vulnerability' => $sqlInjection->id, 
                'title' => 'SQL Injection Error based - Level 1', 
                'name' => $sqlInjection->name, 
                'name_detail' => 'sql_injection_error_based_level_1', 
                'type' => 'error_based', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $commandInjection->id, 
                'title' => 'Command Injection - Level 1', 
                'name' => $commandInjection->name, 
                'name_detail' => 'command_injection_level_1', 
                'type' => 'normal', 
                'level' => 1, 
                'description' => ''
            ],
            [
                'id_vulnerability' => $commandInjection->id, 
                'title' => 'Command Injection - Level 2', 
                'name' => $commandInjection->name, 
                'name_detail' => 'command_injection_level_2', 
                'type' => 'normal', 
                'level' => 2, 
                'description' => ''
            ],
        ];

        foreach ($vulnerabilitiesDetails as $vuln) {
                VulnerabilityDetails::Factory()->create($vuln);
        }
    }
}
