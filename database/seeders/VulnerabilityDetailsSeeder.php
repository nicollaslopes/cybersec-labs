<?php

namespace Database\Seeders;

use App\Models\Vulnerability;
use App\Models\VulnerabilityDetails;
use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

class VulnerabilityDetailsSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $xss = Vulnerability::where('name', 'xss')->first();
        $sqlInjection = Vulnerability::where('name', 'sql_injection')->first();

        $vulnerabilitiesDetails = [
            ['id_vulnerability' => $xss->id, 'title' => 'Reflected XSS - Level 1', 'name' => 'reflected_xss_level_1', 'level' => 1, 'description' => ''],
            ['id_vulnerability' => $xss->id, 'title' => 'Reflected XSS - Level 2', 'name' => 'reflected_xss_level_2', 'level' => 2, 'description' => ''],
            ['id_vulnerability' => $xss->id, 'title' => 'Stored XSS - Level 1', 'name' => 'stored_xss', 'level' => 1, 'description' => ''],
            ['id_vulnerability' => $sqlInjection->id, 'title' => 'SQL Injection', 'name' => 'sql_injection', 'level' => 1, 'description' => ''],
        ];

        foreach ($vulnerabilitiesDetails as $vuln) {
                VulnerabilityDetails::Factory()->create($vuln);
        }
    }
}
